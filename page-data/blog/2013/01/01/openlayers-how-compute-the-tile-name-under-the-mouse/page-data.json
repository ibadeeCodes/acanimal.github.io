{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2013/01/01/openlayers-how-compute-the-tile-name-under-the-mouse/","webpackCompilationHash":"8f6cb71590af4882ab75","result":{"data":{"markdownRemark":{"html":"<p>I have working on a web page using OpenLayers which among others shows a \n<a href=\"http://www.openstreetmap.org/\">OpenStreetMap</a> layer.\nThe issue is I need to move the mouse over the map and print on a label the tile <em>name</em> \nin the form of <strong>z/x/y</strong>, for example, <strong>5/15/10</strong>.</p>\n<p>The approach to done this is:</p>\n<ol>\n<li>register a listener to the OpenLayers <em>map</em> instance and then, for every mouse event triggered,</li>\n<li>get the lonlat and translate it from current map projection to the <a href=\"http://spatialreference.org/ref/epsg/4326/\">EPSG:4326 (WGS84)</a>.</li>\n</ol>\n<p>&nbsp;</p>\n<pre class=\"lang:js decode:true \">map.events.register( 'mousemove', this, function(evt){\n\tvar lonlat = new OpenLayers.LonLat(0, 0);\n\tif(evt){\n\t\tlonlat = map.getLonLatFromPixel(evt.xy);\n\t\tlonlat.transform(this.map.getProjectionObject(), newOpenLayers. Projection(\"EPSG:4326\") );\n\t}\n\ttileX = long2tile(lonlat.lon, map.getZoom());\n\ttileY = latg2tile(lonlat.lat, map.getZoom());\n\ttileZ = map.getZoom();\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">// Print the tilez, tilex and tiley values</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>});</pre></p>\n<p>To compute the tile X,Y grid coordinate from latlon you can use next functions (obtained from <a href=\"http://wiki.openstreetmap.org/wiki/Slippy_map_tilenames#X_and_Y\">OpenStreetMaps</a> site):</p>\n<p>&nbsp;</p>\n<pre class=\"lang:js decode:true \">// Functions to compute tiles from lat/lon\nfunction long2tile(lon,zoom) {\n\treturn (Math.floor((lon+180)/360*Math.pow(2,zoom)));\n}\nfunction lat2tile(lat,zoom)  {\n\treturn (Math.floor((1-Math.log(Math.tan(lat*Math.PI/180) + 1/Math.cos(lat*Math.PI/180))/Math.PI)/2 *Math.pow(2,zoom)));\n} \n</pre>","excerpt":"I have working on a web page using OpenLayers which among others shows a \n  OpenStreetMap layer.\n  The issue is I need to move the mouse over the map and print on a label the tile name \n  in the form of z/x/y, for example, 5/15/10. });","frontmatter":{"date":"01 January, 2013","title":"OpenLayers, how compute the tile \"name\" under the mouse"},"fields":{"slug":"/blog/2013/01/01/openlayers-how-compute-the-tile-name-under-the-mouse/","readingTime":{"text":"1 min read"}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blog/2013/01/01/openlayers-how-compute-the-tile-name-under-the-mouse/"}}}