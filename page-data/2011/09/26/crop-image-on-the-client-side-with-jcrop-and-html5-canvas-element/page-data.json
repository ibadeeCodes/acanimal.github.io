{"componentChunkName":"component---src-templates-blog-post-js","path":"/2011/09/26/crop-image-on-the-client-side-with-jcrop-and-html5-canvas-element/","webpackCompilationHash":"1ee04d26e703fb0db201","result":{"data":{"markdownRemark":{"html":"<p>Suppose you are working on a nice web application where the user can upload images to, for example, a shop catalogue (mmm... that makes me think on something :p ) but wait... you don't the catalogue uses the whole image you upload instead a piece of it. So, we need to crop the image.</p>\n<p><a href=\"http://acuriousanimal.com/code/jcrop_html5canvas/\" rel=\"http://acuriousanimal.com/code/jcrop_html5canvas/\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 650px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 74.6234067207416%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAADQElEQVQoz2P4+PHj8+fPX7169fTp02fPnn389PHJkyevXr0Ecp+/eP7ixYuXL189efL47du3f//+/fXr128Y+PHjB8PLly8PHTx0/vz5w4cO7t+///DhwydOnLh44eLBgwdPnzp16vTpgwcOHDxw8M2bt//////3799/GPjz5w/Du3dv7969c/fO7fv37wHBHSDj3t2Hjx48eHj/yeNHT589efjw/rMXT//9A1r85z8SAGn++PHTw0fPHzx4dv/Os7t3njy4//ze3RcP77998/Lrx3c/3r/98fHdn6+f/v7HACDNL54/3LS+d9+2iYe2LTm0c92h7as3Le9et7Rw7qzC+XMbVi5tXLwgf+a87KVLcs/snwG0/h/YDUASpPn27ZNFeQqnN+a/Pjfl4fnFT6+sProyJDmHwSWYMTFeIiNVMCSGIT9LpDZduL/J8s+fn0A7gYH1BwyAmk+VFmjf2FP8/+myP78f////btX8AJ9kjrZmg+BIQc8w9sBYluhYCStHjswCs99///z9Bw02kOabN44VZ0kUVvMnF4u0TgnYvaPUJYGtpFa8vl7N2IVJ1YpRwYRZyZSZX5khPUXz/6dz//+/3Lm15NSFDUD9DBcuHQsKZaqs5y+o4A5IYIjN447I50kp4XIIY5M1YJTSYRZRZdS2ZnP0EEhJU5oz22n7zorkfPb9hyaCND+5f7uxyG//0pTDa4JK84Ti48WCM6UTSzgNvFlkdFnkdVik1Zi1TNn9/KRaKtyn9Rv4hTO4xzGs3dED0nzn1sWkJJ3tq6P2rg0L9BV0cBL0TZGIKxRxCOSUVGPRMuA0NxM0NhM2N+WvLfTev6UqN8c5t9bmwIkVYGdfORKRIN3QYBERI2VlJmBmyW/lIegXK+HgxyOpyaJpyBniqxwdrOtoK1SS4/Pz9y94OgMF2N3b58Ii5OU0GLQ02Yx1OWVkGSQUGZT1mLVMGJW0GSzMWVwceLzdRX2dBZvLQ/7++QOJ4b///oI0P3p4PTbF3i/IprU2tignMCLULTzKJTbVIzHDKSLBtjjXqbLYPTvPPSPdcf6sKqCtKDZ/+fL1+/efv36AUw1y8vsHQuBYhadHUK6CAEiuAgDExzvvWhRfjQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"jcrop\" title=\"jcrop\" src=\"/static/1261e5b72d3734ffdb7015a4c7cbc424/dbb61/jcrop.png\" srcset=\"/static/1261e5b72d3734ffdb7015a4c7cbc424/19bd1/jcrop.png 163w,\n/static/1261e5b72d3734ffdb7015a4c7cbc424/d3bcb/jcrop.png 325w,\n/static/1261e5b72d3734ffdb7015a4c7cbc424/dbb61/jcrop.png 650w,\n/static/1261e5b72d3734ffdb7015a4c7cbc424/0eed5/jcrop.png 863w\" sizes=\"(max-width: 650px) 100vw, 650px\" loading=\"lazy\">\n    </span></a></p>\n<p>I won&apos;t go in depth on how to create the whole process, in summary:</p>\n<ol>\n<li>User choose an images and app upload to server.</li>\n<li>Wep app shows the images to user and allows him/her to crop the desired piece of image.</li>\n<li>Crop parameters (x, y, widht, height) are sent to server which responsible to really crop the image.</li>\n</ol>\n<p>Here we talk about the step 2: the web page that allows to crop (or choose some image area) and send the parameters to the serve to make the real crop (for example using GD or ImageMagick).</p>\n<p>The real magic comes from <a href=\"http://deepliquid.com/content/Jcrop.html\">JCrop</a>, a jQuery plugin to select areas within an image. As I note in the demo, in the JCrop project page there is a demo that makes a preview of the selection using two &lt;img&gt; elements.</p>\n<p>Here the we are going to make something very similar but using the HTML5 canvas element (to practice a bit :p).</p>\n<p>The first step is to add one img element pointing to the image and one canvas element which will act as the previous:</p>\n<pre class=\"brush:xml\">&lt;img src=&quot;./sago.jpg&quot; id=&quot;target&quot; alt=&quot;Flowers&quot; /&gt;\n&lt;canvas id=&quot;preview&quot; style=&quot;width:150px;height:150px;overflow:hidden;&quot;&gt;&lt;/canvas&gt;</pre>\n<p>Now the code that preview the selected cropped image every time the user updates the selected area:</p>\n<pre class=\"brush:js\">$(&apos;#target&apos;).Jcrop({\n\tonChange : updatePreview,\n\tonSelect : updatePreview,\n\taspectRatio : 1\n});</pre>\n<p>function updatePreview(c) {\nif(parseInt(c.w) > 0) {\n// Show image preview\nvar imageObj = $(\"#target\")[0];\nvar canvas = $(\"#preview\")[0];\nvar context = canvas.getContext(\"2d\");\ncontext.drawImage(imageObj, c.x, c.y, c.w, c.h, 0, 0, canvas.width, canvas.height);\n}\n};</pre></p>\n<p>As you can see the main parameters are the coordinate fields (variable 'c'). One way to send it to server is to store in four hidden input filed in a form, and send them on submit.</p>\n<p>Looking again to the post I think there are too much words to simply show an easy HTML5 canvas example :)</p>","excerpt":"Suppose you are working on a nice web application where the user can upload images to, for example, a shop catalogue (mmm... that makes me think on something :pâ€¦","frontmatter":{"date":"26 September, 2011","title":"Crop image on the client side with JCrop and HTML5 canvas element"},"fields":{"slug":"/2011/09/26/crop-image-on-the-client-side-with-jcrop-and-html5-canvas-element/","readingTime":{"text":"2 min read"}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2011/09/26/crop-image-on-the-client-side-with-jcrop-and-html5-canvas-element/"}}}