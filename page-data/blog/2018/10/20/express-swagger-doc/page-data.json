{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2018/10/20/express-swagger-doc","webpackCompilationHash":"dfd26dbe3cbb7e082b48","result":{"data":{"markdownRemark":{"html":"<p>In past years <a href=\"https://www.openapis.org\">OpenAPI</a> has arise as the preferred way to document APIs. In this article we will see how easy is document an API created with NodeJS and Express through the <a href=\"https://swagger.io/\">Swagger</a> tools.</p>\n<p>If you are working in an REST API you more probably will desire to have some API doc where your users could find what are the endpoints of your API, what they do, which parameters they accept and which output they generate.</p>\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/CE01dwNEkEU\" frameborder=\"0\" allow=\"autoplay; encrypted-media\" allowfullscreen></iframe>\n<!--more-->\n<h2>Swagger</h2>\n<p><a href=\"https://swagger.io/blog/api-strategy/difference-between-swagger-and-openapi/\">Do not confuse OpenAPI with Swagger</a>. OpenAPI is an specification that says how APIs are documented. Swagger is a collection of tools to implement the specification.</p>\n<p>Thanks to Swagger, see the <a href=\"https://editor.swagger.io/\">editor example</a>, writing API docs is not difficult, you only need to write a bunch of YAML lines.</p>\n<p>Among other tools, swagger offers the <a href=\"https://github.com/swagger-api/swagger-ui\">swagger-ui</a>, which is nothing more than <em>a collection of HTML, Javascript, and CSS assets that dynamically generate beautiful documentation from a Swagger-compliant API</em>, or in other words, <code class=\"language-text\">swagger-ui</code> is the beautiful web page ou see in the previous swagger editor link.</p>\n<p>To serve the <code class=\"language-text\">swagger-ui</code> content you only need a web server and the API documentation bundled in a JSON or YAML file.</p>\n<h2>ExpressJS and API documentation</h2>\n<p>When developing APIs with ExpressJS I tend to write my API endpoints in <em>route</em> files (usually also stored under a <code class=\"language-text\">routes</code> folder) which contains the rules to attend requests and, because of this, it is a perfect location to document the endpoints of my API, for example:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * @swagger\n * /users:\n *    get:\n *      description: This should return all users\n */</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/users'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> res<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token string\">'This sould return all users'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The problem is <code class=\"language-text\">swagger-ui</code> requires all my API doc reside in a single file, i.e. <code class=\"language-text\">swagger.json</code>, to be beautified as a web page.</p>\n<h2>How to autogenerate swagger doc ?</h2>\n<p>All the magic resides in the next packages:</p>\n<ul>\n<li><a href=\"https://github.com/scottie1984/swagger-ui-express\">swagger-ui-express</a>: Adds middleware to your express app to serve the Swagger UI bound to your Swagger document. This acts as living documentation for your API hosted from within your app.</li>\n<li><a href=\"https://github.com/Surnet/swagger-jsdoc\">swagger-jsdoc</a>: Generates swagger doc based on JSDoc comments in your code to keep a live and reusable OpenAPI (Swagger) specification.</li>\n</ul>\n<p>So the idea is:</p>\n<ul>\n<li>Document your routes with jsdoc using the swagger YAML notation (as you can see in the previous route).</li>\n<li>Let <code class=\"language-text\">swagger-jsdoc</code> to autogenerate a <code class=\"language-text\">swagger.json</code> file with all the documentation you set in your files.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> swaggerJsdoc <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'swagger-jsdoc'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> options <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  swaggerDefinition<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Like the one described here: https://swagger.io/specification/#infoObject</span>\n    info<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      title<span class=\"token punctuation\">:</span> <span class=\"token string\">'Test API'</span><span class=\"token punctuation\">,</span>\n      version<span class=\"token punctuation\">:</span> <span class=\"token string\">'1.0.0'</span><span class=\"token punctuation\">,</span>\n      description<span class=\"token punctuation\">:</span> <span class=\"token string\">'Test Express API with autogenerated swagger doc'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// List of files to be processes. You can also set globs './routes/*.js'</span>\n  apis<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'endpoints.js'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> specs <span class=\"token operator\">=</span> <span class=\"token function\">swaggerJsdoc</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>Use the <code class=\"language-text\">swagger-ui-express</code> to add a new endpoint where your user can see the documentation.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> swaggerUi <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'swagger-ui-express'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/api-docs'</span><span class=\"token punctuation\">,</span> swaggerUi<span class=\"token punctuation\">.</span>serve<span class=\"token punctuation\">,</span> swaggerUi<span class=\"token punctuation\">.</span><span class=\"token function\">setup</span><span class=\"token punctuation\">(</span>specs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>That is all the magic. At this point if you start and open your browser at <code class=\"language-text\">http://localhost:3000/api-docs</code> you will see the Swagger UI web page with the documentation of your endpoint.</p>\n<p>Of course you can create much more complex documentations. You can include files which only defines includes type definitions (i.e. about input/output data), group your endpoints by tags, etc.</p>\n<p>The important thing is how the convination of <code class=\"language-text\">swagger-ui-express</code> and <code class=\"language-text\">swagger-jsdoc</code> can incredible help and simplify the way to have your API documentation always up to date.</p>","excerpt":"In past years OpenAPI has arise as the preferred way to document APIs. In this article we will see how easy is document an API created with NodeJS and Express through the Swagger tools. If you are working in an REST API you more probably will desire to have some API doc where your users could find what are the endpoints of your API, what they do, which parameters they accept and which output they generate.","frontmatter":{"date":"20 October, 2018","title":"Express API with autogenerated OpenAPI doc through Swagger"},"fields":{"slug":"/blog/2018/10/20/express-swagger-doc","readingTime":{"text":"3 min read"}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blog/2018/10/20/express-swagger-doc"}}}